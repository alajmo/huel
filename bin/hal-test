#!/usr/bin/env node

const defaultConfig = require('../config/default.json');
const program = require('commander');
const tasks = require('../src/tasks/tasks.js');

program
  .option(
    '-p, --pjv',
    `check package.json. [boolean] [default: ${defaultConfig.testPackageJson}]`
  )
  .option('-s, --size [path]', `size limit test. [string]`)
  .on('--help', () => {
    console.log(`

  Examples:

    One time run test
    $ hal test -s src/

    Watch files and run test on file change
    $ hal test -w -s src/
  `);
  })
  .parse(process.argv);

function getTestOptions(options) {
  return Object.freeze({
    pjv: options.pjv || defaultConfig.testPackageJson,
    size: options.size || defaultConfig.size
  });
}

main();
function main() {
  const opt = getTestOptions(program);
  tasks.test(opt);
}
